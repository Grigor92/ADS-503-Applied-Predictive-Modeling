---
title: "ADS 503 Team 4: Predicting Article Shares"
output: html_notebook
---

# Load Data
```{r}
df <- read.csv("Datasets/OnlineNewsPopularity.csv")
dim(df)
```
The dataset has 39,644 samples and 61 variables. 

# Missing Data
```{r}
na.by.col <- apply(df, 2, function(x) sum(is.na(x)))
any(na.by.col > 0)
```
None of the variables are missing any data. 

# Define Target and Predictors
```{r}
df <- df[, names(df) != "url"] # drop the url column, which functions as a sample ID
y <- df$shares  # shares is the target variable 
X <- df[, names(df) != "shares"]
```

# Binary Predictors
```{r}
unique(apply(X, 2, typeof)) # check predictor data types 

is.binary <- function(x) { # function to check whether or not a variable is binary 
  n.unique <- length(unique(x))
  min <- min(x)
  max <- max(x)
  if (n.unique == 2 & min == 0 & max == 1) {
    return(TRUE)
  }
  else {
    return(FALSE)
  }
}

binary.cols <- names(X)[apply(X, 2, is.binary)]
X.binary <- X[, binary.cols]
X.non.binary <- X[, !names(X) %in% binary.cols]
binary.cols
```
All predictors are of data type double. 14 of them are binary variables. 

# Near-Zero Variance Predictors
```{r}
library(caret)
zero.var.cols <- nearZeroVar(X)
names(X)[zero.var.cols]
kw_min_max <- X[, "kw_min_max"]
hist(kw_min_max)
```

kw_min_max is the only predictor with near-zero variance. Let's remove it.
```{r}
X <- X[, names(X) != "kw_min_max"]
```

# Predictor Correlations
## Non-Binary Predictors
```{r}
library(corrplot)
cor.matrix <- cor(X.non.binary)
corrplot(
  cor.matrix, 
  method = "square", 
  type = "upper", 
  order = "hclust",
  tl.pos = "n"
)
high.cor <- findCorrelation(cor.matrix, cutoff = .75) # variables contributing to high pairwise correlations 
length(names(X.non.binary)[high.cor])
```

There are 8 non-binary predictors contributing to high pairwise correlations. Let's remove them to avoid multicolinearity issues. 
```{r}
X.non.binary <- X.non.binary[, -high.cor]
cor.matrix.filtered <- cor(X.non.binary)
corrplot(
  cor.matrix.filtered,
  method = "square",
  type = "upper",
  tl.pos = "n"
)
```






























